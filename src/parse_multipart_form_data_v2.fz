module parse_multipart_form_data_v2(dataa String, boundary String) lock_free.map String String =>

  # replace last boundary
  form_data := (lock_free.map String String).empty
  end_boundary := boundary + "--"
  data := dataa.replace end_boundary boundary+"\r\n"
  parts := data.split (boundary + "\r\n")

  for p in parts do
    lines := p.split "\r\n"
    descr := lines[0]
    content := (lines.drop 1).fold (String.type.concat)
    eq := (descr.find "=")
    if eq.exists
      _ := form_data.add (descr.substring eq.get+2 descr.byte_length-1) content

  form_data
